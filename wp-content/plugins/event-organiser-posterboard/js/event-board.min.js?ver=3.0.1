/*! event-organiser-posterboard 3.0.1 */
!function(a){function b(a,b){this.$el=a,this.template=this._createTemplateFunction(b.template),this.page=0,this.url=b.url,this.i18n={loading:b.loading,load_more:b.load_more},this.query=b.query,this.reversed=b.reversed,this.reversed&&this.$el.addClass("eo-event-board-reversed")}Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1}),b.prototype.init=function(){$container=this.$el.find(".eo-event-board-items");$container.width();this.setMoreText(this.i18n.loading),$container.masonry({isFitWidth:!0,itemSelector:".eo-eb-event-box",isAnimatedFromBottom:!0,isAnimated:!0,singleMode:!0,layoutPriorities:{shelfOrder:0}}),this.fetchEvents()},b.prototype.fetchEvents=function(){this.page++;var b=this,c=this.$el.find(".eo-event-board-items");a.ajax({url:this.url,dataType:"json",data:{action:"eventorganiser-posterboard",page:this.page,query:this.query}}).done(function(a){b.addEvents(a),a.length<b.query.posts_per_page&&b.$el.find(".eo-event-board-more").hide(),b.setMoreText(b.i18n.load_more);var d=b.getActiveFilters();d.length>0&&($hide=b.reversed?c.find("."+d.join(", .")):b.$el.find(".eo-eb-event-box").not("."+d.join(".")),$hide.css({visibility:"hidden",display:"none"}).removeClass("eo-eb-event-box masonry-brick masonry-brick").addClass("eo-eb-event-box-hidden"))})},b.prototype.addEvents=function(b){$container=this.$el.find(".eo-event-board-items");for(var c="",d=0;d<b.length;d++){var e=b[d];c+=this.template(e)}$container.append(a(c)).masonry("appended",a(c),!0),$container.imagesLoaded(function(){$container.masonry("reload")})},b.prototype.hook=function(){this.$el.find(".eo-event-board-more").click(a.proxy(this._onClickMore,this)),this.$el.find(".eo-eb-filter").click(a.proxy(this._onToggleFilter,this))},b.prototype.setMoreText=function(a){this.$el.find(".eo-event-board-more").text(a)},b.prototype.getActiveFilters=function(){var a=this.$el.find(".eo-event-board-filters").data("filters").split(",");return 1==a.length&&""===a[0]&&(a=[]),a},b.prototype.toggleFilter=function(b){var c=this.getActiveFilters(),d=c.indexOf(b),e=d>-1;e?(c.splice(d,1),a.grep(c,function(a){return a}),c.length>0?($show=this.reversed?this.$el.find("."+b).not("."+c.join(", .")):this.$el.find(".eo-eb-event-box-hidden."+c.join(".")),$show.css({visibility:"visible",display:"block"}).addClass("eo-eb-event-box masonry-brick masonry-brick").removeClass("eo-eb-event-box-hidden")):this.$el.find(".eo-eb-event-box-hidden").css({visibility:"visible",display:"block"}).addClass("eo-eb-event-box masonry-brick masonry-brick").removeClass("eo-eb-event-box-hidden")):(c.push(b),$hide=this.reversed?this.$el.find("."+b):this.$el.find(".eo-eb-event-box").not("."+c.join(".")),$hide.css({visibility:"hidden",display:"none"}).removeClass("eo-eb-event-box masonry-brick masonry-brick").addClass("eo-eb-event-box-hidden")),this.$el.find(".eo-event-board-filters").data("filters",c.join(","));var f=b.replace("eo-eb-","eo-eb-filter-");this.$el.find(".eo-event-board-filters ."+f).toggleClass("eo-eb-filter-on",!e),this.$el.find(".eo-event-board-items").masonry("reloadItems").masonry("layout")},b.prototype._onClickMore=function(){this.fetchEvents()},b.prototype._onToggleFilter=function(b){b.preventDefault();var c=a(b.target),d=c.data("filter-type"),e=c.data(d),f="eo-eb-"+d+"-"+e;this.toggleFilter(f)},b.prototype._createTemplateFunction=function(a){var b,c=/\\|'|\r|\n|\t|\u2028|\u2029/g,d={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},e={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},f=new RegExp([d.escape.source,d.interpolate.source,d.evaluate.source].join("|")+"|$","g"),g=0,h="__p+='";a.replace(f,function(b,d,f,i,j){return h+=a.slice(g,j).replace(c,function(a){return"\\"+e[a]}),d&&(h+="'+\n((__t=("+d+"))==null?'':_.escape(__t))+\n'"),f&&(h+="'+\n((__t=("+f+"))==null?'':__t)+\n'"),i&&(h+="';\n"+i+"\n__p+='"),g=j+b.length,b}),h+="';\n",d.variable||(h="with(obj||{}){\n"+h+"}\n"),h="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+h+"return __p;\n";try{b=new Function(d.variable||"obj","_",h)}catch(i){throw i.source=h,i}var j=function(a){return b.call(this,a)};return j},a(document).ready(function(){a(".eo-event-board").each(function(){var c=a(this).data("board"),d=window["eo_posterboard_"+c],e=new b(a(this),{reversed:d.reversed,template:d.template,query:d.query,loading:d.loading,load_more:d.load_more,url:d.url});e.hook(),e.init()})})}(jQuery);